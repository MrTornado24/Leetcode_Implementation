# 给你一个整数数组 arr 和一个目标值 target ，请你返回一个整数 value ，使得将数组中所有大于 value 的值变成 value 后，数组的和最接近  target （最接近表示两者之差的绝对值最小）。
#
# 如果有多种使得和最接近 target 的方案，请你返回这些整数中的最小值。
#
# 请注意，答案不一定是 arr 中的数字。
import bisect
from typing import List
import numpy as np


def findBestValue(self, arr: List[int], target: int) -> int:
    # 暴力检索，无法通过
    #     min_diff = 10 ** 8-1
    # dct = {}
    # if np.sum(arr) <= target:
    #     print("hhh")
    #     return np.max(arr)
    # elif np.min(arr) * len(arr) >= target:
    #     if abs(target // len(arr) * len(arr) - target) < abs((target // len(arr) + 1) * len(arr) - target):
    #         return target // len(arr)
    #     else:
    #         return target // len(arr) + 1
    # else:
    #     print("hhh")
    #     for i in range(np.min(arr), np.max(arr)):
    #         value_arr = [i] * len(arr)
    #         curr = abs(np.sum(np.fmin(arr, value_arr)) - target)
    #         min_diff = min(min_diff, curr)
    #         if curr not in dct or dct[curr] > i:
    #             dct[curr] = i
    # return dct[min_diff]

    # 用二分法进行优化
    # arr.sort()
    # prefix = [0]
    # for i in range(len(arr)):
    #     prefix.append(prefix[-1] + arr[i])
    # ans, r, diff = 0, max(arr), target
    # for i in range(1, r+1):
    #     it = bisect.bisect_left(arr, i)
    #     cur = prefix[it] + (len(arr)-it) * i
    #     if abs(cur-target) < diff:
    #         ans, diff = i, abs(cur-target)
    # return ans

    # 双层枚举法
    arr.sort()
    prefix = [0]
    for i in range(len(arr)):
        prefix.append(prefix[-1]+arr[i])
    l, r, ans = 0, max(arr), -1
    while l <= r:
        mid = (l + r) // 2
        it = bisect.bisect_left(arr, mid)
        cur = prefix[it] + (len(arr) - it) * mid
        if cur <= target:
            ans = mid
            l = mid + 1
        else:
            r = mid - 1

    def check(x):
        return sum(x if num >= x else num for num in arr)

    choose_small = check(ans)
    choose_big = check(ans+1)
    return ans if abs(choose_small-target) <= abs(choose_big-target) else ans+1


print(findBestValue(findBestValue, [9153,71914,87042,37676,36049,48311,35295,19412,47358,54192,75190,45750,39405,83016,31909,19477,27655,14317,5969,95440,86601,17092,40146,67975,65666,90753,45849,79722,67112,98505,77449,80245,75290,87373,75922,11501,73938,51570,62737,24770,71261,12931,98740,35767,25485,38253,10355,6732,16025,81017,48235,91326,93416,52382,88009,1652,31735,31002,14343,22228,54363,51251,86939,75883,71571,18528,45934,14023,69191,12171,94747,91462,64325,53316,18675,82970,57229,2698,5476,88326,73684,63186,17136,51343,86807,98297,4657,48595,2343,6897,37047,48315,44575,56933,7791,95016,85841,61298,20957,5919,94510,50978,16809,55703,2534,81353,73711,63942,35876,25539,90263,78222,48540,79971,35812,38780,76084,13157,7367,26577,19538,3685,71080,96480,45563,25294,67458,83036,19777,71693,43952,92990,12512,97934,50672,13743,57081,24748,58557,48265,36885,38017,65716,4096,27495,50528,13337,36829,38255,96705,70714,94279,11884,70837,7797,39851,55617,24309,23378,86064,69892,13976,5940,94577,71847,89774,72211,1559,90776,89756,68296,25053,34718,20440,28904,6072,22732,91220,52399,81797,43407,66496,86153,16031,41709,67387,43845,80591,46646,86311,11472,67460,81082,49826,70667,30928,92678,78193,11466,26583,51322,96903,39898,60529,4128,57027,86554,75643,95260,30420,64003,55792,51853,17372,99390,34352,65025,65064,11419,83185,43941,93188,11086,22300,30372,75310,39256,87720,68964,34974,59601,95041,11488,82627,91472,26199,56218,84275,37730,94489,76269,60735,22510,71942,67262,51650,24463,67223,34118,81039,20832,6854,3431,91363,4132,48301,34069,86361,25478,56819,1459,12096,88681,79187,70261,85312,41037,72581,30787,92546,17177,75152,1688,42798,6660,8610,48335,20740,90985,70288,42900,17150,3167,61731,9459,17535,12551,78711,68087,3338,23155,8372,9931,49549,63735,2812,66550,28660,37641,29250,68659,49666,51202,76158,48187,9946,67580,68443,72243,42416,6993,28372,69279,65824,31012,73635,88924,19382,88302,75051,75334,75508,65926,71852,36275,45449,53427,81418,82630,23553,62793,78503,62478,65246,84620,91410,48145,47596,61482,56775,28029,38084,45019,17964,75837,82414,7395,40239,90580,90318,28188,98050,65653,29402,12177,33650,32305,38710,2762,44980,82324,4654,45920,72119,9526,9022,47209,6497,95344,31528,19269,18230,45684,45924,96071,40994,64057,93984,5926,67322,99973,91270,38656,25975,23053,57556,15986,10915,89005,47279,12821,25408,38780,56731,38195,85812,24348,27116,30844,13321,79218,31183,6101,42674,16247,87179,74781,97273,70653,75834,14997,96970,93615,84171,17650,7278,2499,24680,46055,4693,11469,86638,62149,94466,9496,51150,98766,37184,65885,20940,14142,86481,66808,34487,60048,64812,75254,88051,11663,4689,10541,18117,52126,95270,96919,64335,57567,61682,34740,24071,97232,93455,83685,44083,34491,23774,70704,63807,44595,38794,97703,2427,96115,99180,21088,48041,89361,94961,97722,10539,62498,38319,83332,82471,53836,62555,52285,76775,65096,6039,87923,43965,97536,14486,40882,94223,32336,84288,47567,71567,56492,7469,77272,30288,44458,43093,23324,48709,50905,16047,36479,73258,54434,74613,63252,47423,52859,71081,75969,41273,62295,69245,41425,25962,79845,60152,92345,39292,74593,23834,47631,14793,10438,65616,54943,84947,81092,49123,60901,68533,92733,12948,95025,18067,15473,11582,42532,92267,365,32053,25224,98856,23057,27445,66711,59323,12636,81373,87278,2300,80205,92120,64193,15194,93372,63491,12856,4986,67242,60850,97919,63602,81462,36301,22175,62613,39967,443,66772,26019,44756,59656,31940,1280,7166,45892,86942,89969,98390,54554,70076,7933,59102,22119,61369,35217,11156,43240,70009,95864,60785,71837,77233,87646,51114,64047,10771,75030,53671,64222,93889,30325,71388,14273,78729,82278,50266,25828,18348,4936,37844,75345,33071,57177,74695,17868,18945,85297,28691,79937,13015,35978,21715,92053,14866,11209,84218,41822,12663,42860,38679,81171,76816,91819,52039,52142,13423,4756,34916,41235,56992,34089,15286,67505,30334,47786,24290,52778,16200,14034,67274,47116,48284,42827,48403,12456,41818,90740,21270,49347,15203,34123,72569,82080,47676,97243,61020,54138,23609,16529,40807,29530,78379,28870,37413,31424,86085,72068,21121,66833,237,10837,94551,26050,35407,94364,4046,6448,4777,48688,40675,49991,86996,87800,10585,47691,39597,67619,42022,61723,72827,25664,92442,21498,94583,57438,66394,83978,47049,6045,1444,21099,53027,57622,11999,39246,219,93293,10850,73936,45281,81667,16688,39384,81800,50014,95241,44758,74180,52433,44030,51149,5353,48345,19035,21010,37065,36687,65015,47452,9228,18111,23752,68152,63544,4032,14282,24604,19234,1050,68631,74876,26243,53121,35133,40484,14369,64765,9668,79708,25471,69083,16943,88308,19193,19961,13802,45904,33050,91753,4518,46997,40972,37717,93363,15226,39891,35218,48714,85267,92286,42348,37332,19433,67466,71879,27790,76081,15249,52926,45445,76614,24534,20510,72636,62088,75991,94220,11520,92180,68785,91325,44807,65633,3069,91930,93611,21376,66142,71116,76882,52057,6358,65701,74682,59833,18731,53129,51763,58050,9885,926,98166,96169,42260,5000,33761,30432,62997,90598,67689,96973,25648,54888,12841,14911,68133,58385,10905,5168,88426,48211,48385,99344,98673,84191,66619,3035,28550,24848,91555,24183,64642,45264,15563,64256,55958,47525,71540,24685,82197,11031,16420,15506,90614,9682,33197,35654,88992,5144,49593,83382,4570,21541,61057,82168,88739,96430,43167,42040,41728,71482,82031,65685,40755,85364,63535,41957,54,29119,7104,66836,77189,8840,94689,43561,83472,7128,18455,72342,9275,54606,46206,40273,44870,57127,4084,64683,8581,97559,38889,72517,7349,42754,30105,64702,88271,5060,10173,47126,94973,1682,5979,91687,72857,58452,60647,2445,51028,43160,28603,31682,50250,57744,45571,1490,46886,65900,30348,61120,73014,7092,58862,87337,72476,75420,86481,84295,63159,40471,28967,85600,64213,3037,72338,51948,74449,25767,37536,35271,50026,80684,3519,58086,94914,15018,96456,63331,66264,13105,31213,5868,57136,40239,1915,76035,7790,45748,53636,1743,81842,55840,70519,22784,32162,35528,53942,63564,33184,51988,14137,95430,34478,98308,93152,45149,63092,31827,17566,60311]
,61430))
